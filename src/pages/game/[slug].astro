---
import "../../styles/global.css";

import games from "../../data/games.json";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
    const games = (await import("../../data/games.json")).default;
    return games.map((game) => ({
        params: { slug: game.slug },
    }));
}

const slug = Astro.params.slug;
const game = games.find((g) => g.slug === slug);

if (!game) throw new Error(`Game not found: ${slug}`);
---

<Layout title={game.opening_es}>
    <header class="mb-8">
        <a href="/" class="text-blue-600 hover:underline font-medium"
            >&larr; Back to games</a
        >
    </header>

    <main class="bg-white dark:bg-gray-800 shadow-lg rounded-xl p-6">
        <!-- Title row -->
        <div class="flex items-center justify-between gap-3">
            <h1 class="text-3xl font-bold mb-2 text-gray-900 dark:text-white">
                {game.opening_es}
            </h1>

            <span
                class="text-sm font-semibold px-2 py-1 rounded-md
                           bg-gray-100 text-gray-700
                           dark:bg-gray-700 dark:text-gray-200"
            >
                RATING: {game.opponent_rating}
            </span>
        </div>

        <div class="mt-2 space-y-2 mb-6">
            {
                game.variation_es && (
                    <p class="text-md mb-6 text-gray-500 dark:text-gray-400">
                        Variante: {game.variation_es}
                    </p>
                )
            }

            <p class="text-gray-600 dark:text-gray-400">
                {game.white}
                <span class="font-semibold dark:font-bold"> vs </span>
                {game.black}
            </p>
        </div>

        <div class="space-y-6">
            <div class="grid gap-4 sm:grid-cols-2 mt-6">
                <!-- YouTube -->
                <a
                    href={game.youtube_link}
                    target="_blank"
                    class="group flex items-center gap-4 rounded-xl border
                           border-gray-200 dark:border-gray-700
                           bg-white dark:bg-gray-800
                           p-4 transition
                           hover:shadow-md dark:hover:shadow-black/30"
                >
                    <div
                        class="flex h-12 w-12 items-center justify-center rounded-full
                               bg-red-100 text-red-600
                               dark:bg-gray-700 dark:text-red-400"
                    >
                        üì∫
                    </div>

                    <div class="flex-1">
                        <p
                            class="font-semibold mb-2 text-gray-900 dark:text-gray-100"
                        >
                            Ver video en YouTube
                        </p>
                        <p class="text-sm text-gray-500 dark:text-gray-400">
                            An√°lisis completo de la partida
                        </p>
                    </div>

                    <span
                        class="text-gray-400 group-hover:translate-x-1 transition-transform"
                    >
                        ‚Üí
                    </span>
                </a>

                <!-- Chess.com -->
                <a
                    href={game.chesscom_link}
                    target="_blank"
                    class="group flex items-center gap-4 rounded-xl border
                           border-gray-200 dark:border-gray-700
                           bg-white dark:bg-gray-800
                           p-4 transition
                           hover:shadow-md dark:hover:shadow-black/30"
                >
                    <div
                        class="flex h-12 w-12 items-center justify-center rounded-full
                               bg-green-100 text-green-700
                               dark:bg-gray-700 dark:text-green-400"
                    >
                        ‚ôüÔ∏è
                    </div>

                    <div class="flex-1">
                        <p
                            class="font-semibold mb-2 text-gray-900 dark:text-gray-100"
                        >
                            Ver partida en chess.com
                        </p>
                        <p class="text-sm text-gray-500 dark:text-gray-400">
                            Repetici√≥n de la partida
                        </p>
                    </div>

                    <span
                        class="text-gray-400 group-hover:translate-x-1 transition-transform"
                    >
                        ‚Üí
                    </span>
                </a>
            </div>
        </div>
    </main>
</Layout>
